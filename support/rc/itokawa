#!/bin/sh
# /etc/init.d/itokawa

### BEGIN INIT INFO
# Provides: itokawa
# Required-Start: $remote_fs $local_fs $network
# Required-Stop: $remote_fs $local_fs $network
# Default-Start: 3 4 5
# Default-Stop: 0 1 6
# Short-Description: Start Application
# Description: Start Application.py automatically.
### END INIT INFO

# User to launch server using
USER=pi
# Directory containing server code
APP_DIR=/mnt/data/projects/Itokawa
# Path to pid file
PID_FILE=/mnt/data/pi/.itokawa/pid

case "$1" in
start)
    cd $APP_DIR
    su $USER -c 'node dist/server/main.js > ~/.itokawa/itokawa.log 2>&1 &'
;;
stop)
    if test -f "$PID_FILE"; then
        kill `cat $PID_FILE`
        rm "$PID_FILE"
    else
        echo "Itokawa doesn't appear to be running"
    fi
;;
*)
echo "Usage: /etc/init.d/itokawa {start|stop}"
exit 1
;;
esac
exit 0